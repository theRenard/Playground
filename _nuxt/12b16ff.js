(window.webpackJsonp=window.webpackJsonp||[]).push([[47,44,46],{288:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(49),o=n(75),h=function(){function t(){Object(r.a)(this,t)}return Object(o.a)(t,[{key:"setSketch",value:function(t){this.sketch=t}},{key:"getSketch",value:function(){return this.sketch}}]),t}()},293:function(t,e,n){"use strict";e.a={rand_range:function(a,b){return Math.random()*(b-a)+a},rand_normalish:function(){return(Math.random()+Math.random()+Math.random()+Math.random())/4*2-1},rand_int:function(a,b){return Math.round(Math.random()*(b-a)+a)},lerp:function(t,a,b){return t*(b-a)+a},smoothstep:function(t,a,b){return(t=t*t*(3-2*t))*(b-a)+a},smootherstep:function(t,a,b){return(t=t*t*t*(t*(6*t-15)+10))*(b-a)+a},clamp:function(t,a,b){return Math.min(Math.max(t,a),b)},sat:function(t){return Math.min(Math.max(t,0),1)}}},342:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return f}));var r=n(49),o=n(75),h=n(293),c=n(287),f=function(){function t(e,n,o,h){Object(r.a)(this,t),this.position=n.clone(),this.radius=[o,h],this.generator=e}return Object(o.a)(t,[{key:"Get",value:function(t,e){var n=this.position.distanceTo(new c.Nb(t,e)),r=1-h.a.sat((n-this.radius[0])/(this.radius[1]-this.radius[0]));return r=r*r*(3-2*r),[this.generator.Get(t,e),r]}}]),t}()},343:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return d}));var r=n(49),o=n(75),h=(n(317),n(11),n(341),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(39),n(26),n(38),n(15),n(27),n(40),n(41),n(18),n(287));function c(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,h=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return h=t.done,t},e:function(t){c=!0,o=t},f:function(){try{h||null==n.return||n.return()}finally{if(c)throw o}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var d=function(){function t(e){var n=e.group,o=e.offset,h=e.scale,c=e.width,f=e.heightGenerators;Object(r.a)(this,t),this.group=n,this.offset=o,this.scale=h,this.width=c,this.heightGenerators=f,this.init()}return Object(o.a)(t,[{key:"init",value:function(){var t=new h.Ob(this.width*this.scale,0,this.width*this.scale);this.plane=new h.R(new h.jb(t.x,t.z,128,128),new h.Y({wireframe:!1,color:255,side:h.v})),this.plane.position.add(this.offset),this.plane.castShadow=!1,this.plane.receiveShadow=!0,this.group.add(this.plane),this.rebuild()}},{key:"rebuild",value:function(){var t=this.offset;console.log("rebuild terrain chunks");for(var e=this.plane.geometry.getAttribute("position"),n=new Float32Array(3*e.count),i=0;i<e.count;i+=1){var r,o=3*i,f=e.array[o+0],d=e.array[o+1],l=0,v=[],y=0,k=c(this.heightGenerators);try{for(k.s();!(r=k.n()).done;){var w=r.value;v.push(w.Get(f+t.x,d+t.y)),y+=v[v.length-1][1]}}catch(t){k.e(t)}finally{k.f()}if(y>0){var m,C=c(v);try{for(C.s();!(m=C.n()).done;){var O=m.value;l+=O[0]*O[1]/y}}catch(t){C.e(t)}finally{C.f()}}n[o+0]=f,n[o+1]=d,n[o+2]=l}var j=new h.i(n,3);this.plane.geometry.setAttribute("position",j),this.heightGenerators.length>1&&0===t.x&&t.y,this.plane.geometry.computeVertexNormals()}}]),t}()},344:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return d}));var r=n(49),o=n(75),h=n(293),c=n(287),f=n(292).default.noise,d=function(){function t(img){Object(r.a)(this,t),this.data=function(image){var canvas=document.createElement("canvas");canvas.width=image.width,canvas.height=image.height;var t=canvas.getContext("2d");return t.drawImage(image,0,0),t.getImageData(0,0,image.width,image.height)}(img)}return Object(o.a)(t,[{key:"Get",value:function(t,e){var n=this,r=function(a,b){var t=4*(a+n.data.width*b);return n.data.data[t]/255},o=new c.Nb(-250,-250),d=new c.Nb(500,500),l=1-h.a.sat((t-o.x)/d.x),v=h.a.sat((e-o.y)/d.y),y=this.data.width-1,k=this.data.height-1,w=Math.floor(l*y),m=Math.floor(v*k),C=h.a.clamp(w+1,0,y),O=h.a.clamp(m+1,0,k),j=l*y-w,S=v*k-m,M=r(w,m),x=r(C,m),G=r(w,O),A=r(C,O),N=h.a.lerp(j,M,x),T=h.a.lerp(j,G,A);return h.a.lerp(S,N,T)*f.height}}]),t}()},358:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return C}));n(139);var r=n(49),o=n(75),h=n(76),c=n(77),f=n(50),d=(n(66),n(287)),l=n(372),v=n(342),y=n(292),k=n(344),w=n(343);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(f.a)(t);if(e){var o=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var C=function(t){Object(h.a)(n,t);var e=m(n);function n(){var t;return Object(r.a)(this,n),(t=e.apply(this,arguments)).chunkSize=500,t}return Object(o.a)(n,[{key:"init",value:function(){this.initNoise(),this.initTerrain()}},{key:"initNoise",value:function(){var t=this,e=function(){for(var e in t.terrainChunks)t.terrainChunks[e].chunk.rebuild()},n=this.getSketch().getGui().addFolder("Terrain.Noise");n.add(y.default.noise,"noiseType",["simplex","perlin"]).onChange(e),n.add(y.default.noise,"scale",64,1024).onChange(e),n.add(y.default.noise,"octaves",1,20,1).onChange(e),n.add(y.default.noise,"persistence",.01,1).onChange(e),n.add(y.default.noise,"lacunarity",.01,4).onChange(e),n.add(y.default.noise,"exponentiation",.1,10).onChange(e),n.add(y.default.noise,"height",0,256).onChange(e),this.noise=new l.default,this.getSketch().getGui().addFolder("Terrain.Heightmap").add(y.default.heightmap,"height",0,128).onChange(e)}},{key:"initTerrain",value:function(){var t=this;this.group=new d.w,this.group.rotation.x=-Math.PI/2,this.getSketch().getScene().add(this.group),this.getSketch().getGui().addFolder("Terrain").add(y.default.terrain,"wireframe").onChange((function(){for(var e in t.terrainChunks)t.terrainChunks[e].chunk.plane.material.wireframe=y.default.terrain.wireframe})),this.terrainChunks={};for(var e=-1;e<=1;e+=1)for(var n=-1;n<=1;n+=1)this.addChunk(e,n)}},{key:"key",value:function(t,e){return"".concat(t,".").concat(e)}},{key:"addChunk",value:function(t,e){for(var n=new d.Nb(t*this.chunkSize,e*this.chunkSize),r=new w.default({group:this.group,offset:new d.Ob(n.x,n.y,0),scale:1,width:this.chunkSize,heightGenerators:[new v.default(this.noise,n,1e5,100001)]}),o=this.key(t,e),h=[],c=-1;c<=1;c+=1)for(var f=-1;f<=1;f+=1)0!==c&&0!==f&&h.push(this.key(t+c,e+f));this.terrainChunks[o]={chunk:r,edges:h}}},{key:"setHeightMap",value:function(img){var t=new v.default(new k.default(img),new d.Nb(0,0),250,300);for(var e in this.terrainChunks)this.terrainChunks[e].chunk.heightGenerators.unshift(t),this.terrainChunks[e].chunk.rebuild()}},{key:"update",value:function(){}},{key:"destroy",value:function(){}}]),n}(n(288).a)}}]);