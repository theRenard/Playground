(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{327:function(e,t,n){"use strict";function o(e,t){var n=e.__state.conversionName.toString(),o=Math.round(e.r),g=Math.round(e.g),b=Math.round(e.b),a=e.a,r=Math.round(e.h),s=e.s.toFixed(1),l=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=e.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+o+","+g+","+b+")":"CSS_RGBA"===n?"rgba("+o+","+g+","+b+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+g+","+b+"]":"RGBA_ARRAY"===n?"["+o+","+g+","+b+","+a+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+g+",b:"+b+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+g+",b:"+b+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+r+",s:"+s+",v:"+l+"}":"HSVA_OBJ"===n?"{h:"+r+",s:"+s+",v:"+l+",a:"+a+"}":"unknown format"}n.d(t,"a",(function(){return be}));var r=Array.prototype.forEach,l=Array.prototype.slice,c={BREAK:{},extend:function(e){return this.each(l.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))}),this),e},defaults:function(e){return this.each(l.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))}),this),e},compose:function(){var e=l.call(arguments);return function(){for(var t=l.call(arguments),i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},each:function(e,t,n){if(e)if(r&&e.forEach&&e.forEach===r)e.forEach(t,n);else if(e.length===e.length+0){var o,l=void 0;for(l=0,o=e.length;l<o;l++)if(l in e&&t.call(n,e[l],l)===this.BREAK)return}else for(var c in e)if(t.call(n,e[c],c)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var o=void 0;return function(){var r=this,l=arguments;function c(){o=null,n||e.apply(r,l)}var d=n||!o;clearTimeout(o),o=setTimeout(c,t),d&&e.apply(r,l)}},toArray:function(e){return e.toArray?e.toArray():l.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},d=[{litmus:c.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:o},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:o},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:o},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:o}}},{litmus:c.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:c.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:c.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(c.isNumber(e.r)&&c.isNumber(e.g)&&c.isNumber(e.b)&&c.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(c.isNumber(e.r)&&c.isNumber(e.g)&&c.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(c.isNumber(e.h)&&c.isNumber(e.s)&&c.isNumber(e.v)&&c.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(c.isNumber(e.h)&&c.isNumber(e.s)&&c.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],h=void 0,f=void 0,m=function(){f=!1;var e=arguments.length>1?c.toArray(arguments):arguments[0];return c.each(d,(function(t){if(t.litmus(e))return c.each(t.conversions,(function(t,n){if(h=t.read(e),!1===f&&!1!==h)return f=h,h.conversionName=n,h.conversion=t,c.BREAK})),c.BREAK})),f},_=void 0,v={hsv_to_rgb:function(e,s,t){var n=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),p=t*(1-s),q=t*(1-o*s),r=t*(1-(1-o)*s),l=[[t,r,p],[q,t,p],[p,t,r],[p,q,t],[r,p,t],[t,p,q]][n];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,g,b){var t=Math.min(e,g,b),n=Math.max(e,g,b),o=n-t,r=void 0;return 0===n?{h:NaN,s:0,v:0}:(r=e===n?(g-b)/o:g===n?2+(b-e)/o:4+(e-g)/o,(r/=6)<0&&(r+=1),{h:360*r,s:o/n,v:n/255})},rgb_to_hex:function(e,g,b){var t=this.hex_with_component(0,2,e);return t=this.hex_with_component(t,1,g),t=this.hex_with_component(t,0,b)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(_=8*t)|e&~(255<<_)}},y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},x=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),E=function e(object,t,n){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,t);if(void 0===desc){var o=Object.getPrototypeOf(object);return null===o?void 0:e(o,t,n)}if("value"in desc)return desc.value;var r=desc.get;return void 0!==r?r.call(n):void 0},A=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},T=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},S=function(){function e(){if(w(this,e),this.__state=m.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return x(e,[{key:"toString",value:function(){return o(this)}},{key:"toHexString",value:function(){return o(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function C(e,component,t){Object.defineProperty(e,component,{get:function(){return"RGB"===this.__state.space||S.recalculateRGB(this,component,t),this.__state[component]},set:function(e){"RGB"!==this.__state.space&&(S.recalculateRGB(this,component,t),this.__state.space="RGB"),this.__state[component]=e}})}function R(e,component){Object.defineProperty(e,component,{get:function(){return"HSV"===this.__state.space||S.recalculateHSV(this),this.__state[component]},set:function(e){"HSV"!==this.__state.space&&(S.recalculateHSV(this),this.__state.space="HSV"),this.__state[component]=e}})}S.recalculateRGB=function(e,component,t){if("HEX"===e.__state.space)e.__state[component]=v.component_from_hex(e.__state.hex,t);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");c.extend(e.__state,v.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},S.recalculateHSV=function(e){var t=v.rgb_to_hsv(e.r,e.g,e.b);c.extend(e.__state,{s:t.s,v:t.v}),c.isNaN(t.h)?c.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},S.COMPONENTS=["r","g","b","h","s","v","hex","a"],C(S.prototype,"r",2),C(S.prototype,"g",1),C(S.prototype,"b",0),R(S.prototype,"h"),R(S.prototype,"s"),R(S.prototype,"v"),Object.defineProperty(S.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(S.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=v.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var O=function(){function e(object,t){w(this,e),this.initialValue=object[t],this.domElement=document.createElement("div"),this.object=object,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return x(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),L={};c.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(e,t){c.each(e,(function(e){L[e]=t}))}));var k=/(\d+(\.\d+)?)px/;function M(e){if("0"===e||c.isUndefined(e))return 0;var t=e.match(k);return c.isNull(t)?0:parseFloat(t[1])}var P={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var o=n,r=t;c.isUndefined(r)&&(r=!0),c.isUndefined(o)&&(o=!0),e.style.position="absolute",r&&(e.style.left=0,e.style.right=0),o&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){var r=n||{},l=L[t];if(!l)throw new Error("Event type "+t+" not supported.");var d=document.createEvent(l);switch(l){case"MouseEvents":var h=r.x||r.clientX||0,f=r.y||r.clientY||0;d.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,h,f,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var m=d.initKeyboardEvent||d.initKeyEvent;c.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),m(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:d.initEvent(t,r.bubbles||!1,r.cancelable||!0)}c.defaults(d,o),e.dispatchEvent(d)},bind:function(e,t,n,o){var r=o||!1;return e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n),P},unbind:function(e,t,n,o){var r=o||!1;return e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n),P},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return P},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),o=n.indexOf(t);-1!==o&&(n.splice(o,1),e.className=n.join(" "))}else e.className=void 0;return P},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var style=getComputedStyle(e);return M(style["border-left-width"])+M(style["border-right-width"])+M(style["padding-left"])+M(style["padding-right"])+M(style.width)},getHeight:function(e){var style=getComputedStyle(e);return M(style["border-top-width"])+M(style["border-bottom-width"])+M(style["padding-top"])+M(style["padding-bottom"])+M(style.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},N=function(e){function t(object,e){w(this,t);var n=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,object,e)),o=n;return n.__prev=n.getValue(),n.__checkbox=document.createElement("input"),n.__checkbox.setAttribute("type","checkbox"),P.bind(n.__checkbox,"change",(function(){o.setValue(!o.__prev)}),!1),n.domElement.appendChild(n.__checkbox),n.updateDisplay(),n}return A(t,e),x(t,[{key:"setValue",value:function(e){var n=E(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),E(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(O),I=function(e){function t(object,e,n){w(this,t);var o=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,object,e)),r=n,l=o;if(o.__select=document.createElement("select"),c.isArray(r)){var map={};c.each(r,(function(element){map[element]=element})),r=map}return c.each(r,(function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),l.__select.appendChild(n)})),o.updateDisplay(),P.bind(o.__select,"change",(function(){var e=this.options[this.selectedIndex].value;l.setValue(e)})),o.domElement.appendChild(o.__select),o}return A(t,e),x(t,[{key:"setValue",value:function(e){var n=E(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return P.isActive(this.__select)?this:(this.__select.value=this.getValue(),E(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(O),H=function(e){function t(object,e){w(this,t);var n=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,object,e)),o=n;function r(){o.setValue(o.__input.value)}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),P.bind(n.__input,"keyup",r),P.bind(n.__input,"change",r),P.bind(n.__input,"blur",(function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())})),P.bind(n.__input,"keydown",(function(e){13===e.keyCode&&this.blur()})),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return A(t,e),x(t,[{key:"updateDisplay",value:function(){return P.isActive(this.__input)||(this.__input.value=this.getValue()),E(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(O);function D(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var j=function(e){function t(object,e,n){w(this,t);var o=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,object,e)),r=n||{};return o.__min=r.min,o.__max=r.max,o.__step=r.step,c.isUndefined(o.__step)?0===o.initialValue?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=D(o.__impliedStep),o}return A(t,e),x(t,[{key:"setValue",value:function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),E(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=D(e),this}}]),t}(O);var F=function(e){function t(object,e,n){w(this,t);var o=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,object,e,n));o.__truncationSuspended=!1;var r=o,l=void 0;function d(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function h(e){var t=l-e.clientY;r.setValue(r.getValue()+t*r.__impliedStep),l=e.clientY}function f(){P.unbind(window,"mousemove",h),P.unbind(window,"mouseup",f),d()}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),P.bind(o.__input,"change",(function(){var e=parseFloat(r.__input.value);c.isNaN(e)||r.setValue(e)})),P.bind(o.__input,"blur",(function(){d()})),P.bind(o.__input,"mousedown",(function(e){P.bind(window,"mousemove",h),P.bind(window,"mouseup",f),l=e.clientY})),P.bind(o.__input,"keydown",(function(e){13===e.keyCode&&(r.__truncationSuspended=!0,this.blur(),r.__truncationSuspended=!1,d())})),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return A(t,e),x(t,[{key:"updateDisplay",value:function(){var e,n,o;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),n=this.__precision,o=Math.pow(10,n),Math.round(e*o)/o),E(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(j);function map(e,t,n,o,r){return o+(e-t)/(n-t)*(r-o)}var U=function(e){function t(object,e,n,o,r){w(this,t);var l=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,object,e,{min:n,max:o,step:r})),c=l;function d(e){e.preventDefault();var t=c.__background.getBoundingClientRect();return c.setValue(map(e.clientX,t.left,t.right,c.__min,c.__max)),!1}function h(){P.unbind(window,"mousemove",d),P.unbind(window,"mouseup",h),c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}function f(e){var t=e.touches[0].clientX,n=c.__background.getBoundingClientRect();c.setValue(map(t,n.left,n.right,c.__min,c.__max))}function m(){P.unbind(window,"touchmove",f),P.unbind(window,"touchend",m),c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}return l.__background=document.createElement("div"),l.__foreground=document.createElement("div"),P.bind(l.__background,"mousedown",(function(e){document.activeElement.blur(),P.bind(window,"mousemove",d),P.bind(window,"mouseup",h),d(e)})),P.bind(l.__background,"touchstart",(function(e){if(1!==e.touches.length)return;P.bind(window,"touchmove",f),P.bind(window,"touchend",m),f(e)})),P.addClass(l.__background,"slider"),P.addClass(l.__foreground,"slider-fg"),l.updateDisplay(),l.__background.appendChild(l.__foreground),l.domElement.appendChild(l.__background),l}return A(t,e),x(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",E(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(j),B=function(e){function t(object,e,text){w(this,t);var n=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,object,e)),o=n;return n.__button=document.createElement("div"),n.__button.innerHTML=void 0===text?"Fire":text,P.bind(n.__button,"click",(function(e){return e.preventDefault(),o.fire(),!1})),P.addClass(n.__button,"button"),n.domElement.appendChild(n.__button),n}return A(t,e),x(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(O),V=function(e){function t(object,e){w(this,t);var n=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,object,e));n.__color=new S(n.getValue()),n.__temp=new S(0);var o=n;n.domElement=document.createElement("div"),P.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",P.bind(n.__input,"keydown",(function(e){13===e.keyCode&&v.call(this)})),P.bind(n.__input,"blur",v),P.bind(n.__selector,"mousedown",(function(){P.addClass(this,"drag").bind(window,"mouseup",(function(){P.removeClass(o.__selector,"drag")}))})),P.bind(n.__selector,"touchstart",(function(){P.addClass(this,"drag").bind(window,"touchend",(function(){P.removeClass(o.__selector,"drag")}))}));var r,l=document.createElement("div");function d(e){x(e),P.bind(window,"mousemove",x),P.bind(window,"touchmove",x),P.bind(window,"mouseup",f),P.bind(window,"touchend",f)}function h(e){E(e),P.bind(window,"mousemove",E),P.bind(window,"touchmove",E),P.bind(window,"mouseup",_),P.bind(window,"touchend",_)}function f(){P.unbind(window,"mousemove",x),P.unbind(window,"touchmove",x),P.unbind(window,"mouseup",f),P.unbind(window,"touchend",f),y()}function _(){P.unbind(window,"mousemove",E),P.unbind(window,"touchmove",E),P.unbind(window,"mouseup",_),P.unbind(window,"touchend",_),y()}function v(){var i=m(this.value);!1!==i?(o.__color.__state=i,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function y(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function x(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,r=n.clientX,l=n.clientY,s=(r-t.left)/(t.right-t.left),c=1-(l-t.top)/(t.bottom-t.top);return c>1?c=1:c<0&&(c=0),s>1?s=1:s<0&&(s=0),o.__color.v=c,o.__color.s=s,o.setValue(o.__color.toOriginal()),!1}function E(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__hue_field.getBoundingClientRect(),n=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return n>1?n=1:n<0&&(n=0),o.__color.h=360*n,o.setValue(o.__color.toOriginal()),!1}return c.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),c.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),c.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),c.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),c.extend(l.style,{width:"100%",height:"100%",background:"none"}),z(l,"top","rgba(0,0,0,0)","#000"),c.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(r=n.__hue_field).style.background="",r.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",r.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",r.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",r.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",r.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",c.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),P.bind(n.__saturation_field,"mousedown",d),P.bind(n.__saturation_field,"touchstart",d),P.bind(n.__field_knob,"mousedown",d),P.bind(n.__field_knob,"touchstart",d),P.bind(n.__hue_field,"mousedown",h),P.bind(n.__hue_field,"touchstart",h),n.__saturation_field.appendChild(l),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}return A(t,e),x(t,[{key:"updateDisplay",value:function(){var i=m(this.getValue());if(!1!==i){var e=!1;c.each(S.COMPONENTS,(function(component){if(!c.isUndefined(i[component])&&!c.isUndefined(this.__color.__state[component])&&i[component]!==this.__color.__state[component])return e=!0,{}}),this),e&&c.extend(this.__color.__state,i)}c.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var t=this.__color.v<.5||this.__color.s>.5?255:0,n=255-t;c.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+t+","+t+","+t+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,z(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),c.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+t+","+t+","+t+")",textShadow:this.__input_textShadow+"rgba("+n+","+n+","+n+",.7)"})}}]),t}(O),G=["-moz-","-o-","-webkit-","-ms-",""];function z(e,t,a,b){e.style.background="",c.each(G,(function(n){e.style.cssText+="background: "+n+"linear-gradient("+t+", "+a+" 0%, "+b+" 100%); "}))}var K=function(e,t){var n=t||document,o=document.createElement("style");o.type="text/css",o.innerHTML=e;var head=n.getElementsByTagName("head")[0];try{head.appendChild(o)}catch(e){}},X='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',Y=function(object,e){var t=object[e];return c.isArray(arguments[2])||c.isObject(arguments[2])?new I(object,e,arguments[2]):c.isNumber(t)?c.isNumber(arguments[2])&&c.isNumber(arguments[3])?c.isNumber(arguments[4])?new U(object,e,arguments[2],arguments[3],arguments[4]):new U(object,e,arguments[2],arguments[3]):c.isNumber(arguments[4])?new F(object,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new F(object,e,{min:arguments[2],max:arguments[3]}):c.isString(t)?new H(object,e):c.isFunction(t)?new B(object,e,""):c.isBoolean(t)?new N(object,e):null};var W=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},J=function(){function e(){w(this,e),this.backgroundElement=document.createElement("div"),c.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),P.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),c.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;P.bind(this.backgroundElement,"click",(function(){t.hide()}))}return x(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),c.defer((function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",P.unbind(e.domElement,"webkitTransitionEnd",t),P.unbind(e.domElement,"transitionend",t),P.unbind(e.domElement,"oTransitionEnd",t)};P.bind(this.domElement,"webkitTransitionEnd",t),P.bind(this.domElement,"transitionend",t),P.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-P.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-P.getHeight(this.domElement)/2+"px"}}]),e}();K(function(e){if(e&&"undefined"!=typeof window){var style=document.createElement("style");return style.setAttribute("type","text/css"),style.innerHTML=e,document.head.appendChild(style),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var Z="Default",Q=function(){try{return!!window.localStorage}catch(e){return!1}}(),$=void 0,ee=!0,te=void 0,ne=!1,oe=[],se=function e(t){var n=this,o=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),P.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=c.defaults(o,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),o=c.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),c.isUndefined(o.load)?o.load={preset:Z}:o.preset&&(o.load.preset=o.preset),c.isUndefined(o.parent)&&o.hideable&&oe.push(this),o.resizable=c.isUndefined(o.parent)&&o.resizable,o.autoPlace&&c.isUndefined(o.scrollable)&&(o.scrollable=!0);var r,l=Q&&"true"===localStorage.getItem(ue(this,"isLocal")),d=void 0,h=void 0;if(Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:o.load.preset},set:function(e){n.parent?n.getRoot().preset=e:o.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,me(n,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,h&&(h.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(t){o.closed=t,o.closed?P.addClass(n.__ul,e.CLASS_CLOSED):P.removeClass(n.__ul,e.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return l},set:function(e){Q&&(l=e,e?P.bind(window,"unload",d):P.unbind(window,"unload",d),localStorage.setItem(ue(n,"isLocal"),e))}}}),c.isUndefined(o.parent)){if(this.closed=o.closed||!1,P.addClass(this.domElement,e.CLASS_MAIN),P.makeSelectable(this.domElement,!1),Q&&l){n.useLocalStorage=!0;var f=localStorage.getItem(ue(this,"gui"));f&&(o.load=JSON.parse(f))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,P.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),o.closeOnTop?(P.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(P.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),P.bind(this.__closeButton,"click",(function(){n.closed=!n.closed}))}else{void 0===o.closed&&(o.closed=!0);var m=document.createTextNode(o.name);P.addClass(m,"controller-name"),h=ie(n,m);P.addClass(this.__ul,e.CLASS_CLOSED),P.addClass(h,"title"),P.bind(h,"click",(function(e){return e.preventDefault(),n.closed=!n.closed,!1})),o.closed||(this.closed=!1)}o.autoPlace&&(c.isUndefined(o.parent)&&(ee&&(te=document.createElement("div"),P.addClass(te,"dg"),P.addClass(te,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(te),ee=!1),te.appendChild(this.domElement),P.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||me(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},P.bind(window,"resize",this.__resizeHandler),P.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),P.bind(this.__ul,"transitionend",this.__resizeHandler),P.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&fe(this),d=function(){Q&&"true"===localStorage.getItem(ue(n,"isLocal"))&&localStorage.setItem(ue(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=d,o.parent||((r=n.getRoot()).width+=1,c.defer((function(){r.width-=1})))};function ie(e,t,n){var li=document.createElement("li");return t&&li.appendChild(t),n?e.__ul.insertBefore(li,n):e.__ul.appendChild(li),e.onResize(),li}function re(e){P.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&P.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function ae(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function le(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var r=n.__rememberedObjectIndecesToControllers[o];if(void 0===r&&(r={},n.__rememberedObjectIndecesToControllers[o]=r),r[t.property]=t,n.load&&n.load.remembered){var l=n.load.remembered,c=void 0;if(l[e.preset])c=l[e.preset];else{if(!l.Default)return;c=l.Default}if(c[o]&&void 0!==c[o][t.property]){var d=c[o][t.property];t.initialValue=d,t.setValue(d)}}}}function ce(e,object,t,n){if(void 0===object[t])throw new Error('Object "'+object+'" has no property "'+t+'"');var o=void 0;if(n.color)o=new V(object,t);else{var r=[object,t].concat(n.factoryArgs);o=Y.apply(e,r)}n.before instanceof O&&(n.before=n.before.__li),le(e,o),P.addClass(o.domElement,"c");var l=document.createElement("span");P.addClass(l,"property-name"),l.innerHTML=o.property;var d=document.createElement("div");d.appendChild(l),d.appendChild(o.domElement);var li=ie(e,d,n.before);return P.addClass(li,se.CLASS_CONTROLLER_ROW),o instanceof V?P.addClass(li,"color"):P.addClass(li,y(o.getValue())),function(e,li,t){if(t.__li=li,t.__gui=e,c.extend(t,{options:function(n){if(arguments.length>1){var o=t.__li.nextElementSibling;return t.remove(),ce(e,t.object,t.property,{before:o,factoryArgs:[c.toArray(arguments)]})}if(c.isArray(n)||c.isObject(n)){var r=t.__li.nextElementSibling;return t.remove(),ce(e,t.object,t.property,{before:r,factoryArgs:[n]})}},name:function(e){return t.__li.firstElementChild.firstElementChild.innerHTML=e,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof U){var n=new F(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});c.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(e){var o=t[e],r=n[e];t[e]=n[e]=function(){var e=Array.prototype.slice.call(arguments);return r.apply(n,e),o.apply(t,e)}})),P.addClass(li,"has-slider"),t.domElement.insertBefore(n.domElement,t.domElement.firstElementChild)}else if(t instanceof F){var o=function(n){if(c.isNumber(t.__min)&&c.isNumber(t.__max)){var o=t.__li.firstElementChild.firstElementChild.innerHTML,r=t.__gui.__listening.indexOf(t)>-1;t.remove();var l=ce(e,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return l.name(o),r&&l.listen(),l}return n};t.min=c.compose(o,t.min),t.max=c.compose(o,t.max)}else t instanceof N?(P.bind(li,"click",(function(){P.fakeEvent(t.__checkbox,"click")})),P.bind(t.__checkbox,"click",(function(e){e.stopPropagation()}))):t instanceof B?(P.bind(li,"click",(function(){P.fakeEvent(t.__button,"click")})),P.bind(li,"mouseover",(function(){P.addClass(t.__button,"hover")})),P.bind(li,"mouseout",(function(){P.removeClass(t.__button,"hover")}))):t instanceof V&&(P.addClass(li,"color"),t.updateDisplay=c.compose((function(e){return li.style.borderLeftColor=t.__color.toString(),e}),t.updateDisplay),t.updateDisplay());t.setValue=c.compose((function(n){return e.getRoot().__preset_select&&t.isModified()&&ae(e.getRoot(),!0),n}),t.setValue)}(e,li,o),e.__controllers.push(o),o}function ue(e,t){return document.location.href+"."+t}function de(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function he(e,t){t.style.display=e.useLocalStorage?"block":"none"}function pe(e){var div=e.__save_row=document.createElement("li");P.addClass(e.domElement,"has-save"),e.__ul.insertBefore(div,e.__ul.firstChild),P.addClass(div,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",P.addClass(t,"button gears");var button=document.createElement("span");button.innerHTML="Save",P.addClass(button,"button"),P.addClass(button,"save");var n=document.createElement("span");n.innerHTML="New",P.addClass(n,"button"),P.addClass(n,"save-as");var o=document.createElement("span");o.innerHTML="Revert",P.addClass(o,"button"),P.addClass(o,"revert");var select=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?c.each(e.load.remembered,(function(t,n){de(e,n,n===e.preset)})):de(e,Z,!1),P.bind(select,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value})),div.appendChild(select),div.appendChild(t),div.appendChild(button),div.appendChild(n),div.appendChild(o),Q){var r=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(ue(0,"isLocal"))&&l.setAttribute("checked","checked"),he(e,r),P.bind(l,"change",(function(){e.useLocalStorage=!e.useLocalStorage,he(e,r)}))}var d=document.getElementById("dg-new-constructor");P.bind(d,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||$.hide()})),P.bind(t,"click",(function(){d.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),$.show(),d.focus(),d.select()})),P.bind(button,"click",(function(){e.save()})),P.bind(n,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)})),P.bind(o,"click",(function(){e.revert()}))}function fe(e){var t=void 0;function n(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function o(){P.removeClass(e.__closeButton,se.CLASS_DRAG),P.unbind(window,"mousemove",n),P.unbind(window,"mouseup",o)}function r(r){return r.preventDefault(),t=r.clientX,P.addClass(e.__closeButton,se.CLASS_DRAG),P.bind(window,"mousemove",n),P.bind(window,"mouseup",o),!1}e.__resize_handle=document.createElement("div"),c.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),P.bind(e.__resize_handle,"mousedown",r),P.bind(e.__closeButton,"mousedown",r),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function me(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function _e(e,t){var n={};return c.each(e.__rememberedObjects,(function(o,r){var l={},d=e.__rememberedObjectIndecesToControllers[r];c.each(d,(function(e,n){l[n]=t?e.initialValue:e.getValue()})),n[r]=l})),n}function ge(e){0!==e.length&&W.call(window,(function(){ge(e)})),c.each(e,(function(e){e.updateDisplay()}))}se.toggleHide=function(){ne=!ne,c.each(oe,(function(e){e.domElement.style.display=ne?"none":""}))},se.CLASS_AUTO_PLACE="a",se.CLASS_AUTO_PLACE_CONTAINER="ac",se.CLASS_MAIN="main",se.CLASS_CONTROLLER_ROW="cr",se.CLASS_TOO_TALL="taller-than-window",se.CLASS_CLOSED="closed",se.CLASS_CLOSE_BUTTON="close-button",se.CLASS_CLOSE_TOP="close-top",se.CLASS_CLOSE_BOTTOM="close-bottom",se.CLASS_DRAG="drag",se.DEFAULT_WIDTH=245,se.TEXT_CLOSED="Close Controls",se.TEXT_OPEN="Open Controls",se._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||se.toggleHide()},P.bind(window,"keydown",se._keydownHandler,!1),c.extend(se.prototype,{add:function(object,e){return ce(this,object,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(object,e){return ce(this,object,e,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;c.defer((function(){t.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&te.removeChild(this.domElement);var e=this;c.each(this.__folders,(function(t){e.removeFolder(t)})),P.unbind(window,"keydown",se._keydownHandler,!1),re(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new se(t);this.__folders[e]=n;var li=ie(this,n.domElement);return P.addClass(li,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],re(e);var t=this;c.each(e.__folders,(function(t){e.removeFolder(t)})),c.defer((function(){t.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=P.getOffset(e.__ul).top,n=0;c.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(n+=P.getHeight(t))})),window.innerHeight-t-20<n?(P.addClass(e.domElement,se.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(P.removeClass(e.domElement,se.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&c.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:c.debounce((function(){this.onResize()}),50),remember:function(){if(c.isUndefined($)&&(($=new J).domElement.innerHTML=X),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;c.each(Array.prototype.slice.call(arguments),(function(object){0===e.__rememberedObjects.length&&pe(e),-1===e.__rememberedObjects.indexOf(object)&&e.__rememberedObjects.push(object)})),this.autoPlace&&me(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=_e(this)),e.folders={},c.each(this.__folders,(function(element,t){e.folders[t]=element.getSaveObject()})),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=_e(this),ae(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=_e(this,!0)),this.load.remembered[e]=_e(this),this.preset=e,de(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){c.each(this.__controllers,(function(t){this.getRoot().load.remembered?le(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this),c.each(this.__folders,(function(e){e.revert(e)})),e||ae(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&ge(this.__listening)},updateDisplay:function(){c.each(this.__controllers,(function(e){e.updateDisplay()})),c.each(this.__folders,(function(e){e.updateDisplay()}))}});var be=se},328:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(273);const r={type:"change"},l={type:"start"},c={type:"end"};class d extends o.s{constructor(object,e){super(),void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=object,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new o.Ob,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:o.N.ROTATE,MIDDLE:o.N.DOLLY,RIGHT:o.N.PAN},this.touches={ONE:o.Gb.ROTATE,TWO:o.Gb.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",ee),this._domElementKeyEvents=e},this.saveState=function(){t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=function(){t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(r),t.update(),d=n.NONE},this.update=function(){const e=new o.Ob,l=(new o.pb).setFromUnitVectors(object.up,new o.Ob(0,1,0)),c=l.clone().invert(),w=new o.Ob,x=new o.pb,E=2*Math.PI;return function(){const o=t.object.position;e.copy(o).sub(t.target),e.applyQuaternion(l),f.setFromVector3(e),t.autoRotate&&d===n.NONE&&P(2*Math.PI/60/60*t.autoRotateSpeed),t.enableDamping?(f.theta+=m.theta*t.dampingFactor,f.phi+=m.phi*t.dampingFactor):(f.theta+=m.theta,f.phi+=m.phi);let A=t.minAzimuthAngle,T=t.maxAzimuthAngle;return isFinite(A)&&isFinite(T)&&(A<-Math.PI?A+=E:A>Math.PI&&(A-=E),T<-Math.PI?T+=E:T>Math.PI&&(T-=E),f.theta=A<=T?Math.max(A,Math.min(T,f.theta)):f.theta>(A+T)/2?Math.max(A,f.theta):Math.min(T,f.theta)),f.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=_,f.radius=Math.max(t.minDistance,Math.min(t.maxDistance,f.radius)),!0===t.enableDamping?t.target.addScaledVector(v,t.dampingFactor):t.target.add(v),e.setFromSpherical(f),e.applyQuaternion(c),o.copy(t.target).add(e),t.object.lookAt(t.target),!0===t.enableDamping?(m.theta*=1-t.dampingFactor,m.phi*=1-t.dampingFactor,v.multiplyScalar(1-t.dampingFactor)):(m.set(0,0,0),v.set(0,0,0)),_=1,!!(y||w.distanceToSquared(t.object.position)>h||8*(1-x.dot(t.object.quaternion))>h)&&(t.dispatchEvent(r),w.copy(t.object.position),x.copy(t.object.quaternion),y=!1,!0)}}(),this.dispose=function(){t.domElement.removeEventListener("contextmenu",te),t.domElement.removeEventListener("pointerdown",W),t.domElement.removeEventListener("pointercancel",Q),t.domElement.removeEventListener("wheel",$),t.domElement.removeEventListener("pointermove",J),t.domElement.removeEventListener("pointerup",Z),null!==t._domElementKeyEvents&&t._domElementKeyEvents.removeEventListener("keydown",ee)};const t=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=n.NONE;const h=1e-6,f=new o.Eb,m=new o.Eb;let _=1;const v=new o.Ob;let y=!1;const w=new o.Nb,x=new o.Nb,E=new o.Nb,A=new o.Nb,T=new o.Nb,S=new o.Nb,C=new o.Nb,R=new o.Nb,O=new o.Nb,L=[],k={};function M(){return Math.pow(.95,t.zoomSpeed)}function P(e){m.theta-=e}function N(e){m.phi-=e}const I=function(){const e=new o.Ob;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),v.add(e)}}(),H=function(){const e=new o.Ob;return function(n,o){!0===t.screenSpacePanning?e.setFromMatrixColumn(o,1):(e.setFromMatrixColumn(o,0),e.crossVectors(t.object.up,e)),e.multiplyScalar(n),v.add(e)}}(),D=function(){const e=new o.Ob;return function(n,o){const element=t.domElement;if(t.object.isPerspectiveCamera){const r=t.object.position;e.copy(r).sub(t.target);let l=e.length();l*=Math.tan(t.object.fov/2*Math.PI/180),I(2*n*l/element.clientHeight,t.object.matrix),H(2*o*l/element.clientHeight,t.object.matrix)}else t.object.isOrthographicCamera?(I(n*(t.object.right-t.object.left)/t.object.zoom/element.clientWidth,t.object.matrix),H(o*(t.object.top-t.object.bottom)/t.object.zoom/element.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}}();function j(e){t.object.isPerspectiveCamera?_/=e:t.object.isOrthographicCamera?(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom*e)),t.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function F(e){t.object.isPerspectiveCamera?_*=e:t.object.isOrthographicCamera?(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/e)),t.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function U(e){w.set(e.clientX,e.clientY)}function B(e){A.set(e.clientX,e.clientY)}function V(){if(1===L.length)w.set(L[0].pageX,L[0].pageY);else{const e=.5*(L[0].pageX+L[1].pageX),t=.5*(L[0].pageY+L[1].pageY);w.set(e,t)}}function G(){if(1===L.length)A.set(L[0].pageX,L[0].pageY);else{const e=.5*(L[0].pageX+L[1].pageX),t=.5*(L[0].pageY+L[1].pageY);A.set(e,t)}}function z(){const e=L[0].pageX-L[1].pageX,t=L[0].pageY-L[1].pageY,n=Math.sqrt(e*e+t*t);C.set(0,n)}function K(e){if(1==L.length)x.set(e.pageX,e.pageY);else{const t=se(e),n=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);x.set(n,o)}E.subVectors(x,w).multiplyScalar(t.rotateSpeed);const element=t.domElement;P(2*Math.PI*E.x/element.clientHeight),N(2*Math.PI*E.y/element.clientHeight),w.copy(x)}function X(e){if(1===L.length)T.set(e.pageX,e.pageY);else{const t=se(e),n=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);T.set(n,o)}S.subVectors(T,A).multiplyScalar(t.panSpeed),D(S.x,S.y),A.copy(T)}function Y(e){const n=se(e),o=e.pageX-n.x,r=e.pageY-n.y,l=Math.sqrt(o*o+r*r);R.set(0,l),O.set(0,Math.pow(R.y/C.y,t.zoomSpeed)),j(O.y),C.copy(R)}function W(e){!1!==t.enabled&&(0===L.length&&(t.domElement.setPointerCapture(e.pointerId),t.domElement.addEventListener("pointermove",J),t.domElement.addEventListener("pointerup",Z)),function(e){L.push(e)}(e),"touch"===e.pointerType?function(e){switch(oe(e),L.length){case 1:switch(t.touches.ONE){case o.Gb.ROTATE:if(!1===t.enableRotate)return;V(),d=n.TOUCH_ROTATE;break;case o.Gb.PAN:if(!1===t.enablePan)return;G(),d=n.TOUCH_PAN;break;default:d=n.NONE}break;case 2:switch(t.touches.TWO){case o.Gb.DOLLY_PAN:if(!1===t.enableZoom&&!1===t.enablePan)return;t.enableZoom&&z(),t.enablePan&&G(),d=n.TOUCH_DOLLY_PAN;break;case o.Gb.DOLLY_ROTATE:if(!1===t.enableZoom&&!1===t.enableRotate)return;t.enableZoom&&z(),t.enableRotate&&V(),d=n.TOUCH_DOLLY_ROTATE;break;default:d=n.NONE}break;default:d=n.NONE}d!==n.NONE&&t.dispatchEvent(l)}(e):function(e){let r;switch(e.button){case 0:r=t.mouseButtons.LEFT;break;case 1:r=t.mouseButtons.MIDDLE;break;case 2:r=t.mouseButtons.RIGHT;break;default:r=-1}switch(r){case o.N.DOLLY:if(!1===t.enableZoom)return;!function(e){C.set(e.clientX,e.clientY)}(e),d=n.DOLLY;break;case o.N.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===t.enablePan)return;B(e),d=n.PAN}else{if(!1===t.enableRotate)return;U(e),d=n.ROTATE}break;case o.N.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===t.enableRotate)return;U(e),d=n.ROTATE}else{if(!1===t.enablePan)return;B(e),d=n.PAN}break;default:d=n.NONE}d!==n.NONE&&t.dispatchEvent(l)}(e))}function J(e){!1!==t.enabled&&("touch"===e.pointerType?function(e){switch(oe(e),d){case n.TOUCH_ROTATE:if(!1===t.enableRotate)return;K(e),t.update();break;case n.TOUCH_PAN:if(!1===t.enablePan)return;X(e),t.update();break;case n.TOUCH_DOLLY_PAN:if(!1===t.enableZoom&&!1===t.enablePan)return;!function(e){t.enableZoom&&Y(e),t.enablePan&&X(e)}(e),t.update();break;case n.TOUCH_DOLLY_ROTATE:if(!1===t.enableZoom&&!1===t.enableRotate)return;!function(e){t.enableZoom&&Y(e),t.enableRotate&&K(e)}(e),t.update();break;default:d=n.NONE}}(e):function(e){if(!1===t.enabled)return;switch(d){case n.ROTATE:if(!1===t.enableRotate)return;!function(e){x.set(e.clientX,e.clientY),E.subVectors(x,w).multiplyScalar(t.rotateSpeed);const element=t.domElement;P(2*Math.PI*E.x/element.clientHeight),N(2*Math.PI*E.y/element.clientHeight),w.copy(x),t.update()}(e);break;case n.DOLLY:if(!1===t.enableZoom)return;!function(e){R.set(e.clientX,e.clientY),O.subVectors(R,C),O.y>0?j(M()):O.y<0&&F(M()),C.copy(R),t.update()}(e);break;case n.PAN:if(!1===t.enablePan)return;!function(e){T.set(e.clientX,e.clientY),S.subVectors(T,A).multiplyScalar(t.panSpeed),D(S.x,S.y),A.copy(T),t.update()}(e)}}(e))}function Z(e){!1!==t.enabled&&(e.pointerType,t.dispatchEvent(c),d=n.NONE,ne(e),0===L.length&&(t.domElement.releasePointerCapture(e.pointerId),t.domElement.removeEventListener("pointermove",J),t.domElement.removeEventListener("pointerup",Z)))}function Q(e){ne(e)}function $(e){!1===t.enabled||!1===t.enableZoom||d!==n.NONE&&d!==n.ROTATE||(e.preventDefault(),t.dispatchEvent(l),function(e){e.deltaY<0?F(M()):e.deltaY>0&&j(M()),t.update()}(e),t.dispatchEvent(c))}function ee(e){!1!==t.enabled&&!1!==t.enablePan&&function(e){let n=!1;switch(e.code){case t.keys.UP:D(0,t.keyPanSpeed),n=!0;break;case t.keys.BOTTOM:D(0,-t.keyPanSpeed),n=!0;break;case t.keys.LEFT:D(t.keyPanSpeed,0),n=!0;break;case t.keys.RIGHT:D(-t.keyPanSpeed,0),n=!0}n&&(e.preventDefault(),t.update())}(e)}function te(e){!1!==t.enabled&&e.preventDefault()}function ne(e){delete k[e.pointerId];for(let i=0;i<L.length;i++)if(L[i].pointerId==e.pointerId)return void L.splice(i,1)}function oe(e){let t=k[e.pointerId];void 0===t&&(t=new o.Nb,k[e.pointerId]=t),t.set(e.pageX,e.pageY)}function se(e){const t=e.pointerId===L[0].pointerId?L[1]:L[0];return k[t.pointerId]}t.domElement.addEventListener("contextmenu",te),t.domElement.addEventListener("pointerdown",W),t.domElement.addEventListener("pointercancel",Q),t.domElement.addEventListener("wheel",$,{passive:!1}),this.update()}}},329:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var o=n(273);const r=/^[og]\s*(.+)?/,l=/^mtllib /,c=/^usemtl /,d=/^usemap /,h=new o.Ob,f=new o.Ob,m=new o.Ob,_=new o.Ob,v=new o.Ob;function y(){const e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){const n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);const o={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){const t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(o),o},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){const t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(let e=this.materials.length-1;e>=0;e--)this.materials[e].groupCount<=0&&this.materials.splice(e,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},n&&n.name&&"function"==typeof n.clone){const e=n.clone(0);e.inherited=!0,this.object.materials.push(e)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){const n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(a,b,e){const t=this.vertices,n=this.object.geometry.vertices;n.push(t[a+0],t[a+1],t[a+2]),n.push(t[b+0],t[b+1],t[b+2]),n.push(t[e+0],t[e+1],t[e+2])},addVertexPoint:function(a){const e=this.vertices;this.object.geometry.vertices.push(e[a+0],e[a+1],e[a+2])},addVertexLine:function(a){const e=this.vertices;this.object.geometry.vertices.push(e[a+0],e[a+1],e[a+2])},addNormal:function(a,b,e){const t=this.normals,n=this.object.geometry.normals;n.push(t[a+0],t[a+1],t[a+2]),n.push(t[b+0],t[b+1],t[b+2]),n.push(t[e+0],t[e+1],t[e+2])},addFaceNormal:function(a,b,e){const t=this.vertices,n=this.object.geometry.normals;h.fromArray(t,a),f.fromArray(t,b),m.fromArray(t,e),v.subVectors(m,f),_.subVectors(h,f),v.cross(_),v.normalize(),n.push(v.x,v.y,v.z),n.push(v.x,v.y,v.z),n.push(v.x,v.y,v.z)},addColor:function(a,b,e){const t=this.colors,n=this.object.geometry.colors;void 0!==t[a]&&n.push(t[a+0],t[a+1],t[a+2]),void 0!==t[b]&&n.push(t[b+0],t[b+1],t[b+2]),void 0!==t[e]&&n.push(t[e+0],t[e+1],t[e+2])},addUV:function(a,b,e){const t=this.uvs,n=this.object.geometry.uvs;n.push(t[a+0],t[a+1]),n.push(t[b+0],t[b+1]),n.push(t[e+0],t[e+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(a){const e=this.uvs;this.object.geometry.uvs.push(e[a+0],e[a+1])},addFace:function(a,b,e,t,n,o,r,l,c){const d=this.vertices.length;let h=this.parseVertexIndex(a,d),f=this.parseVertexIndex(b,d),m=this.parseVertexIndex(e,d);if(this.addVertex(h,f,m),this.addColor(h,f,m),void 0!==r&&""!==r){const e=this.normals.length;h=this.parseNormalIndex(r,e),f=this.parseNormalIndex(l,e),m=this.parseNormalIndex(c,e),this.addNormal(h,f,m)}else this.addFaceNormal(h,f,m);if(void 0!==t&&""!==t){const e=this.uvs.length;h=this.parseUVIndex(t,e),f=this.parseUVIndex(n,e),m=this.parseUVIndex(o,e),this.addUV(h,f,m),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let n=0,o=e.length;n<o;n++){const o=this.parseVertexIndex(e[n],t);this.addVertexPoint(o),this.addColor(o)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const n=this.vertices.length,o=this.uvs.length;for(let t=0,o=e.length;t<o;t++)this.addVertexLine(this.parseVertexIndex(e[t],n));for(let e=0,n=t.length;e<n;e++)this.addUVLine(this.parseUVIndex(t[e],o))}};return e.startObject("",!1),e}class w extends o.K{constructor(e){super(e),this.materials=null}load(e,t,n,r){const l=this,c=new o.t(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,(function(text){try{t(l.parse(text))}catch(t){r?r(t):console.error(t),l.manager.itemError(e)}}),n,r)}setMaterials(e){return this.materials=e,this}parse(text){const e=new y;-1!==text.indexOf("\r\n")&&(text=text.replace(/\r\n/g,"\n")),-1!==text.indexOf("\\\n")&&(text=text.replace(/\\\n/g,""));const t=text.split("\n");let line="",n="",h=0,f=[];const m="function"==typeof"".trimLeft;for(let i=0,o=t.length;i<o;i++)if(line=t[i],line=m?line.trimLeft():line.trim(),h=line.length,0!==h&&(n=line.charAt(0),"#"!==n))if("v"===n){const data=line.split(/\s+/);switch(data[0]){case"v":e.vertices.push(parseFloat(data[1]),parseFloat(data[2]),parseFloat(data[3])),data.length>=7?e.colors.push(parseFloat(data[4]),parseFloat(data[5]),parseFloat(data[6])):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(data[1]),parseFloat(data[2]),parseFloat(data[3]));break;case"vt":e.uvs.push(parseFloat(data[1]),parseFloat(data[2]))}}else if("f"===n){const t=line.substr(1).trim().split(/\s+/),n=[];for(let e=0,o=t.length;e<o;e++){const o=t[e];if(o.length>0){const e=o.split("/");n.push(e)}}const o=n[0];for(let t=1,r=n.length-1;t<r;t++){const r=n[t],l=n[t+1];e.addFace(o[0],r[0],l[0],o[1],r[1],l[1],o[2],r[2],l[2])}}else if("l"===n){const t=line.substring(1).trim().split(" ");let n=[];const o=[];if(-1===line.indexOf("/"))n=t;else for(let li=0,e=t.length;li<e;li++){const e=t[li].split("/");""!==e[0]&&n.push(e[0]),""!==e[1]&&o.push(e[1])}e.addLineGeometry(n,o)}else if("p"===n){const t=line.substr(1).trim().split(" ");e.addPointGeometry(t)}else if(null!==(f=r.exec(line))){const t=(" "+f[0].substr(1).trim()).substr(1);e.startObject(t)}else if(c.test(line))e.object.startMaterial(line.substring(7).trim(),e.materialLibraries);else if(l.test(line))e.materialLibraries.push(line.substring(7).trim());else if(d.test(line))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===n){if(f=line.split(" "),f.length>1){const t=f[1].trim().toLowerCase();e.object.smooth="0"!==t&&"off"!==t}else e.object.smooth=!0;const t=e.object.currentMaterial();t&&(t.smooth=e.object.smooth)}else{if("\0"===line)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+line+'"')}e.finalize();const _=new o.w;_.materialLibraries=[].concat(e.materialLibraries);if(!0===!(1===e.objects.length&&0===e.objects[0].geometry.vertices.length))for(let i=0,t=e.objects.length;i<t;i++){const object=e.objects[i],t=object.geometry,n=object.materials,r="Line"===t.type,l="Points"===t.type;let c=!1;if(0===t.vertices.length)continue;const d=new o.j;d.setAttribute("position",new o.u(t.vertices,3)),t.normals.length>0&&d.setAttribute("normal",new o.u(t.normals,3)),t.colors.length>0&&(c=!0,d.setAttribute("color",new o.u(t.colors,3))),!0===t.hasUVIndices&&d.setAttribute("uv",new o.u(t.uvs,2));const h=[];for(let t=0,d=n.length;t<d;t++){const d=n[t],f=d.name+"_"+d.smooth+"_"+c;let m=e.materials[f];if(null!==this.materials)if(m=this.materials.create(d.name),!r||!m||m instanceof o.E){if(l&&m&&!(m instanceof o.nb)){const e=new o.nb({size:10,sizeAttenuation:!1});o.O.prototype.copy.call(e,m),e.color.copy(m.color),e.map=m.map,m=e}}else{const e=new o.E;o.O.prototype.copy.call(e,m),e.color.copy(m.color),m=e}void 0===m&&(m=r?new o.E:l?new o.nb({size:1,sizeAttenuation:!1}):new o.W,m.name=d.name,m.flatShading=!d.smooth,m.vertexColors=c,e.materials[f]=m),h.push(m)}let f;if(h.length>1){for(let e=0,t=n.length;e<t;e++){const t=n[e];d.addGroup(t.groupStart,t.groupCount,e)}f=r?new o.G(d,h):l?new o.mb(d,h):new o.R(d,h)}else f=r?new o.G(d,h[0]):l?new o.mb(d,h[0]):new o.R(d,h[0]);f.name=object.name,_.add(f)}else if(e.vertices.length>0){const t=new o.nb({size:1,sizeAttenuation:!1}),n=new o.j;n.setAttribute("position",new o.u(e.vertices,3)),e.colors.length>0&&void 0!==e.colors[0]&&(n.setAttribute("color",new o.u(e.colors,3)),t.vertexColors=!0);const r=new o.mb(n,t);_.add(r)}return _}}},330:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(273);class r extends o.o{constructor(e){super(e)}parse(e,t){const n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function r(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function l(e,t,n,o){const r=n*o*4,l=new Uint8Array(e,t,r),c=new Uint8Array(r);let d=0,h=0;for(let e=0;e<o;e++)for(let e=0;e<n;e++){const b=l[h];h++;const g=l[h];h++;const e=l[h];h++;const a=l[h];h++,c[d]=e,d++,c[d]=g,d++,c[d]=b,d++,c[d]=a,d++}return c}const c=r("DXT1"),d=r("DXT3"),h=r("DXT5"),f=r("ETC1"),header=new Int32Array(e,0,31);if(542327876!==header[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),n;if(4&!header[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),n;let m;const _=header[21];let v=!1;switch(_){case c:m=8,n.format=o.wb;break;case d:m=16,n.format=o.sb;break;case h:m=16,n.format=o.tb;break;case f:m=8,n.format=o.vb;break;default:if(!(32===header[22]&&16711680&header[23]&&65280&header[24]&&255&header[25]&&4278190080&header[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",(y=_,String.fromCharCode(255&y,y>>8&255,y>>16&255,y>>24&255))),n;v=!0,m=64,n.format=o.rb}var y;n.mipmapCount=1,131072&header[2]&&!1!==t&&(n.mipmapCount=Math.max(1,header[7]));const w=header[28];if(n.isCubemap=!!(512&w),n.isCubemap&&(!(1024&w)||!(2048&w)||!(4096&w)||!(8192&w)||!(16384&w)||!(32768&w)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),n;n.width=header[4],n.height=header[3];let x=header[1]+4;const E=n.isCubemap?6:1;for(let t=0;t<E;t++){let t=n.width,o=n.height;for(let i=0;i<n.mipmapCount;i++){let r,c;v?(r=l(e,x,t,o),c=r.length):(c=Math.max(4,t)/4*Math.max(4,o)/4*m,r=new Uint8Array(e,x,c));const d={data:r,width:t,height:o};n.mipmaps.push(d),x+=c,t=Math.max(t>>1,1),o=Math.max(o>>1,1)}}return n}}},331:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(273);class r extends o.K{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new f(e)})),this.register((function(e){return new w(e)})),this.register((function(e){return new x(e)})),this.register((function(e){return new m(e)})),this.register((function(e){return new _(e)})),this.register((function(e){return new v(e)})),this.register((function(e){return new y(e)})),this.register((function(e){return new d(e)})),this.register((function(e){return new E(e)}))}load(e,t,n,r){const l=this;let c;c=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:o.L.extractUrlBase(e),this.manager.itemStart(e);const d=function(t){r?r(t):console.error(t),l.manager.itemError(e),l.manager.itemEnd(e)},h=new o.t(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(e,(function(data){try{l.parse(data,c,(function(n){t(n),l.manager.itemEnd(e)}),d)}catch(e){d(e)}}),n,d)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(data,path,e,t){let content;const n={},r={};if("string"==typeof data)content=data;else{if(o.L.decodeText(new Uint8Array(data,0,4))===A){try{n[c.KHR_BINARY_GLTF]=new C(data)}catch(e){return void(t&&t(e))}content=n[c.KHR_BINARY_GLTF].content}else content=o.L.decodeText(new Uint8Array(data))}const l=JSON.parse(content);if(void 0===l.asset||l.asset.version[0]<2)return void(t&&t(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const d=new ie(l,{path:path||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let i=0;i<this.pluginCallbacks.length;i++){const e=this.pluginCallbacks[i](d);r[e.name]=e,n[e.name]=!0}if(l.extensionsUsed)for(let i=0;i<l.extensionsUsed.length;++i){const e=l.extensionsUsed[i],t=l.extensionsRequired||[];switch(e){case c.KHR_MATERIALS_UNLIT:n[e]=new h;break;case c.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:n[e]=new k;break;case c.KHR_DRACO_MESH_COMPRESSION:n[e]=new R(l,this.dracoLoader);break;case c.KHR_TEXTURE_TRANSFORM:n[e]=new O;break;case c.KHR_MESH_QUANTIZATION:n[e]=new M;break;default:t.indexOf(e)>=0&&void 0===r[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}d.setExtensions(n),d.setPlugins(r),d.parse(e,t)}}function l(){let e={};return{get:function(t){return e[t]},add:function(t,object){e[t]=object},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const c={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class d{constructor(e){this.parser=e,this.name=c.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,o=t.length;n<o;n++){const o=t[n];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const l=t.json,c=((l.extensions&&l.extensions[this.name]||{}).lights||[])[e];let d;const h=new o.n(16777215);void 0!==c.color&&h.fromArray(c.color);const f=void 0!==c.range?c.range:0;switch(c.type){case"directional":d=new o.p(h),d.target.position.set(0,0,-1),d.add(d.target);break;case"point":d=new o.kb(h),d.distance=f;break;case"spot":d=new o.Fb(h),d.distance=f,c.spot=c.spot||{},c.spot.innerConeAngle=void 0!==c.spot.innerConeAngle?c.spot.innerConeAngle:0,c.spot.outerConeAngle=void 0!==c.spot.outerConeAngle?c.spot.outerConeAngle:Math.PI/4,d.angle=c.spot.outerConeAngle,d.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,d.target.position.set(0,0,-1),d.add(d.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return d.position.set(0,0,0),d.decay=2,void 0!==c.intensity&&(d.intensity=c.intensity),d.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(d),t.cache.add(n,r),r}createNodeAttachment(e){const t=this,n=this.parser,o=n.json.nodes[e],r=(o.extensions&&o.extensions[this.name]||{}).light;return void 0===r?null:this._loadLight(r).then((function(e){return n._getNodeRef(t.cache,r,e)}))}}class h{constructor(){this.name=c.KHR_MATERIALS_UNLIT}getMaterialType(){return o.S}extendParams(e,t,n){const r=[];e.color=new o.n(1,1,1),e.opacity=1;const l=t.pbrMetallicRoughness;if(l){if(Array.isArray(l.baseColorFactor)){const t=l.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==l.baseColorTexture&&r.push(n.assignTexture(e,"map",l.baseColorTexture))}return Promise.all(r)}}class f{constructor(e){this.parser=e,this.name=c.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?o.X:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const l=[],c=r.extensions[this.name];if(void 0!==c.clearcoatFactor&&(t.clearcoat=c.clearcoatFactor),void 0!==c.clearcoatTexture&&l.push(n.assignTexture(t,"clearcoatMap",c.clearcoatTexture)),void 0!==c.clearcoatRoughnessFactor&&(t.clearcoatRoughness=c.clearcoatRoughnessFactor),void 0!==c.clearcoatRoughnessTexture&&l.push(n.assignTexture(t,"clearcoatRoughnessMap",c.clearcoatRoughnessTexture)),void 0!==c.clearcoatNormalTexture&&(l.push(n.assignTexture(t,"clearcoatNormalMap",c.clearcoatNormalTexture)),void 0!==c.clearcoatNormalTexture.scale)){const e=c.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new o.Nb(e,-e)}return Promise.all(l)}}class m{constructor(e){this.parser=e,this.name=c.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?o.X:null}extendMaterialParams(e,t){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=[],l=o.extensions[this.name];return void 0!==l.transmissionFactor&&(t.transmission=l.transmissionFactor),void 0!==l.transmissionTexture&&r.push(n.assignTexture(t,"transmissionMap",l.transmissionTexture)),Promise.all(r)}}class _{constructor(e){this.parser=e,this.name=c.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?o.X:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const l=[],c=r.extensions[this.name];t.thickness=void 0!==c.thicknessFactor?c.thicknessFactor:0,void 0!==c.thicknessTexture&&l.push(n.assignTexture(t,"thicknessMap",c.thicknessTexture)),t.attenuationDistance=c.attenuationDistance||0;const d=c.attenuationColor||[1,1,1];return t.attenuationTint=new o.n(d[0],d[1],d[2]),Promise.all(l)}}class v{constructor(e){this.parser=e,this.name=c.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?o.X:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const o=n.extensions[this.name];return t.ior=void 0!==o.ior?o.ior:1.5,Promise.resolve()}}class y{constructor(e){this.parser=e,this.name=c.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?o.X:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const l=[],c=r.extensions[this.name];t.specularIntensity=void 0!==c.specularFactor?c.specularFactor:1,void 0!==c.specularTexture&&l.push(n.assignTexture(t,"specularIntensityMap",c.specularTexture));const d=c.specularColorFactor||[1,1,1];return t.specularTint=new o.n(d[0],d[1],d[2]),void 0!==c.specularColorTexture&&l.push(n.assignTexture(t,"specularTintMap",c.specularColorTexture).then((function(e){e.encoding=o.Rb}))),Promise.all(l)}}class w{constructor(e){this.parser=e,this.name=c.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,o=n.textures[e];if(!o.extensions||!o.extensions[this.name])return null;const r=o.extensions[this.name],source=n.images[r.source],l=t.options.ktx2Loader;if(!l){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,source,l)}}class x{constructor(e){this.parser=e,this.name=c.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,o=n.json,r=o.textures[e];if(!r.extensions||!r.extensions[t])return null;const l=r.extensions[t],source=o.images[l.source];let c=n.textureLoader;if(source.uri){const e=n.options.manager.getHandler(source.uri);null!==e&&(c=e)}return this.detectSupport().then((function(r){if(r)return n.loadTextureImage(e,source,c);if(o.extensionsRequired&&o.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const image=new Image;image.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",image.onload=image.onerror=function(){e(1===image.height)}}))),this.isSupported}}class E{constructor(e){this.name=c.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],o=this.parser.getDependency("buffer",e.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([o,r.ready]).then((function(t){const n=e.byteOffset||0,o=e.byteLength||0,l=e.count,c=e.byteStride,d=new ArrayBuffer(l*c),source=new Uint8Array(t[0],n,o);return r.decodeGltfBuffer(new Uint8Array(d),l,c,source,e.mode,e.filter),d}))}return null}}const A="glTF",T=1313821514,S=5130562;class C{constructor(data){this.name=c.KHR_BINARY_GLTF,this.content=null,this.body=null;const e=new DataView(data,0,12);if(this.header={magic:o.L.decodeText(new Uint8Array(data.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==A)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const t=this.header.length-12,n=new DataView(data,12);let r=0;for(;r<t;){const e=n.getUint32(r,!0);r+=4;const t=n.getUint32(r,!0);if(r+=4,t===T){const t=new Uint8Array(data,12+r,e);this.content=o.L.decodeText(t)}else if(t===S){const t=12+r;this.body=data.slice(t,t+e)}r+=e}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class R{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=c.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,o=this.dracoLoader,r=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,c={},d={},h={};for(const e in l){const t=K[e]||e.toLowerCase();c[t]=l[e]}for(const t in e.attributes){const o=K[t]||t.toLowerCase();if(void 0!==l[t]){const r=n.accessors[e.attributes[t]],l=B[r.componentType];h[o]=l,d[o]=!0===r.normalized}}return t.getDependency("bufferView",r).then((function(e){return new Promise((function(t){o.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],o=d[t];void 0!==o&&(n.normalized=o)}t(e)}),c,h)}))}))}}class O{constructor(){this.name=c.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class L extends o.Y{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),l=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),c=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),d={specular:{value:(new o.n).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=d,this.onBeforeCompile=function(e){for(const t in d)e.uniforms[t]=d[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",l).replace("#include <lights_physical_fragment>",c)},Object.defineProperties(this,{specular:{get:function(){return d.specular.value},set:function(e){d.specular.value=e}},specularMap:{get:function(){return d.specularMap.value},set:function(e){d.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return d.glossiness.value},set:function(e){d.glossiness.value=e}},glossinessMap:{get:function(){return d.glossinessMap.value},set:function(e){d.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(source){return super.copy(source),this.specularMap=source.specularMap,this.specular.copy(source.specular),this.glossinessMap=source.glossinessMap,this.glossiness=source.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class k{constructor(){this.name=c.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return L}extendParams(e,t,n){const r=t.extensions[this.name];e.color=new o.n(1,1,1),e.opacity=1;const l=[];if(Array.isArray(r.diffuseFactor)){const t=r.diffuseFactor;e.color.fromArray(t),e.opacity=t[3]}if(void 0!==r.diffuseTexture&&l.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new o.n(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new o.n(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){const t=r.specularGlossinessTexture;l.push(n.assignTexture(e,"glossinessMap",t)),l.push(n.assignTexture(e,"specularMap",t))}return Promise.all(l)}createMaterial(e){const t=new L(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=o.Hb,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}class M{constructor(){this.name=c.KHR_MESH_QUANTIZATION}}class P extends o.A{constructor(e,t,n,o){super(e,t,n,o)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,o=this.valueSize,r=e*o*3+o;for(let i=0;i!==o;i++)t[i]=n[r+i];return t}}P.prototype.beforeStart_=P.prototype.copySampleValue_,P.prototype.afterEnd_=P.prototype.copySampleValue_,P.prototype.interpolate_=function(e,t,n,o){const r=this.resultBuffer,l=this.sampleValues,c=this.valueSize,d=2*c,h=3*c,td=o-t,p=(n-t)/td,f=p*p,m=f*p,_=e*h,v=_-h,y=-2*m+3*f,w=m-f,x=1-y,E=w-f+p;for(let i=0;i!==c;i++){const e=l[v+i+c],t=l[v+i+d]*td,n=l[_+i+c],o=l[_+i]*td;r[i]=x*e+E*t+y*n+w*o}return r};const N=0,I=1,H=2,D=3,j=4,F=5,U=6,B={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},V={9728:o.bb,9729:o.H,9984:o.db,9985:o.J,9986:o.cb,9987:o.I},G={33071:o.l,33648:o.ab,10497:o.xb},z={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},K={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},X={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Y={CUBICSPLINE:void 0,LINEAR:o.C,STEP:o.B},W="OPAQUE",J="MASK",Z="BLEND";function Q(e,path){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(path)&&/^\//.test(e)&&(path=path.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:path+e)}function $(e,object,t){for(const n in t.extensions)void 0===e[n]&&(object.userData.gltfExtensions=object.userData.gltfExtensions||{},object.userData.gltfExtensions[n]=t.extensions[n])}function ee(object,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(object.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function te(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let i=0,n=t.weights.length;i<n;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let i=0,t=n.length;i<t;i++)e.morphTargetDictionary[n[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ne(e){const t=e.extensions&&e.extensions[c.KHR_DRACO_MESH_COMPRESSION];let n;return n=t?"draco:"+t.bufferView+":"+t.indices+":"+oe(t.attributes):e.indices+":"+oe(e.attributes)+":"+e.mode,n}function oe(e){let t="";const n=Object.keys(e).sort();for(let i=0,o=n.length;i<o;i++)t+=n[i]+":"+e[n[i]]+";";return t}function se(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class ie{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new l,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new o.x(this.options.manager):this.textureLoader=new o.Jb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new o.t(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,o=this.json,r=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const l={scene:t[0][o.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:o.asset,parser:n,userData:{}};$(r,l,o),ee(l,o),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(l)}))).then((function(){e(l)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let n=0,o=t.length;n<o;n++){const o=t[n].joints;for(let i=0,t=o.length;i<t;i++)e[o[i]].isBone=!0}for(let t=0,o=e.length;t<o;t++){const o=e[t];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(n[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,object){if(e.refs[t]<=1)return object;const n=object.clone();return n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const n=e(t[i]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const o=e(t[i]);o&&n.push(o)}return n}getDependency(e,t){const n=e+":"+t;let o=this.cache.get(n);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":o=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,o)}return o}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,defs=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(defs.map((function(t,o){return n.getDependency(e,o)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[c.KHR_BINARY_GLTF].body);const o=this.options;return new Promise((function(e,r){n.load(Q(t.uri,o.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,o=t.byteOffset||0;return e.slice(o,o+n)}))}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);const l=[];return void 0!==r.bufferView?l.push(this.getDependency("bufferView",r.bufferView)):l.push(null),void 0!==r.sparse&&(l.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),l.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(l).then((function(e){const l=e[0],c=z[r.type],d=B[r.componentType],h=d.BYTES_PER_ELEMENT,f=h*c,m=r.byteOffset||0,_=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,v=!0===r.normalized;let y,w;if(_&&_!==f){const e=Math.floor(m/_),n="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+e+":"+r.count;let f=t.cache.get(n);f||(y=new d(l,e*_,r.count*_/h),f=new o.y(y,_/h),t.cache.add(n,f)),w=new o.z(f,c,m%_/h,v)}else y=null===l?new d(r.count*c):new d(l,m,r.count*c),w=new o.i(y,c,v);if(void 0!==r.sparse){const t=z.SCALAR,n=B[r.sparse.indices.componentType],h=r.sparse.indices.byteOffset||0,f=r.sparse.values.byteOffset||0,m=new n(e[1],h,r.sparse.count*t),_=new d(e[2],f,r.sparse.count*c);null!==l&&(w=new o.i(w.array.slice(),w.itemSize,w.normalized));for(let i=0,e=m.length;i<e;i++){const e=m[i];if(w.setX(e,_[i*c]),c>=2&&w.setY(e,_[i*c+1]),c>=3&&w.setZ(e,_[i*c+2]),c>=4&&w.setW(e,_[i*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w}))}loadTexture(e){const t=this.json,n=this.options,o=t.textures[e],source=t.images[o.source];let r=this.textureLoader;if(source.uri){const e=n.manager.getHandler(source.uri);null!==e&&(r=e)}return this.loadTextureImage(e,source,r)}loadTextureImage(e,source,t){const n=this,r=this.json,l=this.options,c=r.textures[e],d=(source.uri||source.bufferView)+":"+c.sampler;if(this.textureCache[d])return this.textureCache[d];const h=self.URL||self.webkitURL;let f=source.uri||"",m=!1,_=!0;const v=f.search(/\.jpe?g($|\?)/i)>0||0===f.search(/^data\:image\/jpeg/);if(("image/jpeg"===source.mimeType||v)&&(_=!1),void 0!==source.bufferView)f=n.getDependency("bufferView",source.bufferView).then((function(e){if("image/png"===source.mimeType){const t=new DataView(e,25,1).getUint8(0,!1);_=6===t||4===t||3===t}m=!0;const t=new Blob([e],{type:source.mimeType});return f=h.createObjectURL(t),f}));else if(void 0===source.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const y=Promise.resolve(f).then((function(e){return new Promise((function(n,r){let c=n;!0===t.isImageBitmapLoader&&(c=function(e){const t=new o.Ib(e);t.needsUpdate=!0,n(t)}),t.load(Q(e,l.path),c,void 0,r)}))})).then((function(t){!0===m&&h.revokeObjectURL(f),t.flipY=!1,c.name&&(t.name=c.name),_||(t.format=o.ub);const l=(r.samplers||{})[c.sampler]||{};return t.magFilter=V[l.magFilter]||o.H,t.minFilter=V[l.minFilter]||o.I,t.wrapS=G[l.wrapS]||o.xb,t.wrapT=G[l.wrapT]||o.xb,n.associations.set(t,{type:"textures",index:e}),t})).catch((function(){return console.error("THREE.GLTFLoader: Couldn't load texture",f),null}));return this.textureCache[d]=y,y}assignTexture(e,t,n){const o=this;return this.getDependency("texture",n.index).then((function(r){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),o.extensions[c.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[c.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=o.associations.get(r);r=o.extensions[c.KHR_TEXTURE_TRANSFORM].extendTexture(r,e),o.associations.set(r,t)}}return e[t]=r,r}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0!==t.attributes.tangent,l=void 0!==t.attributes.color,c=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new o.nb,o.O.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new o.E,o.O.prototype.copy.call(t,n),t.color.copy(n.color),this.cache.add(e,t)),n=t}if(r||l||c){let e="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(e+="specular-glossiness:"),r&&(e+="vertex-tangents:"),l&&(e+="vertex-colors:"),c&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),l&&(t.vertexColors=!0),c&&(t.flatShading=!0),r&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return o.Y}loadMaterial(e){const t=this,n=this.json,r=this.extensions,l=n.materials[e];let d;const h={},f=l.extensions||{},m=[];if(f[c.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const e=r[c.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];d=e.getMaterialType(),m.push(e.extendParams(h,l,t))}else if(f[c.KHR_MATERIALS_UNLIT]){const e=r[c.KHR_MATERIALS_UNLIT];d=e.getMaterialType(),m.push(e.extendParams(h,l,t))}else{const n=l.pbrMetallicRoughness||{};if(h.color=new o.n(1,1,1),h.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;h.color.fromArray(e),h.opacity=e[3]}void 0!==n.baseColorTexture&&m.push(t.assignTexture(h,"map",n.baseColorTexture)),h.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,h.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(m.push(t.assignTexture(h,"metalnessMap",n.metallicRoughnessTexture)),m.push(t.assignTexture(h,"roughnessMap",n.metallicRoughnessTexture))),d=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),m.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,h)}))))}!0===l.doubleSided&&(h.side=o.r);const _=l.alphaMode||W;return _===Z?(h.transparent=!0,h.depthWrite=!1):(h.transparent=!1,_===J&&(h.alphaTest=void 0!==l.alphaCutoff?l.alphaCutoff:.5)),void 0!==l.normalTexture&&d!==o.S&&(m.push(t.assignTexture(h,"normalMap",l.normalTexture)),h.normalScale=new o.Nb(1,-1),void 0!==l.normalTexture.scale&&h.normalScale.set(l.normalTexture.scale,-l.normalTexture.scale)),void 0!==l.occlusionTexture&&d!==o.S&&(m.push(t.assignTexture(h,"aoMap",l.occlusionTexture)),void 0!==l.occlusionTexture.strength&&(h.aoMapIntensity=l.occlusionTexture.strength)),void 0!==l.emissiveFactor&&d!==o.S&&(h.emissive=(new o.n).fromArray(l.emissiveFactor)),void 0!==l.emissiveTexture&&d!==o.S&&m.push(t.assignTexture(h,"emissiveMap",l.emissiveTexture)),Promise.all(m).then((function(){let n;return n=d===L?r[c.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(h):new d(h),l.name&&(n.name=l.name),n.map&&(n.map.encoding=o.Rb),n.emissiveMap&&(n.emissiveMap.encoding=o.Rb),ee(n,l),t.associations.set(n,{type:"materials",index:e}),l.extensions&&$(r,n,l),n}))}createUniqueName(e){const t=o.ob.sanitizeNodeName(e||"");let n=t;for(let i=1;this.nodeNamesUsed[n];++i)n=t+"_"+i;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function l(e){return n[c.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return ae(n,e,t)}))}const d=[];for(let i=0,n=e.length;i<n;i++){const n=e[i],h=ne(n),f=r[h];if(f)d.push(f.promise);else{let e;e=n.extensions&&n.extensions[c.KHR_DRACO_MESH_COMPRESSION]?l(n):ae(new o.j,n,t),r[h]={primitive:n,promise:e},d.push(e)}}return Promise.all(d)}loadMesh(e){const t=this,n=this.json,r=this.extensions,l=n.meshes[e],c=l.primitives,d=[];for(let i=0,e=c.length;i<e;i++){const e=void 0===c[i].material?(void 0===(h=this.cache).DefaultMaterial&&(h.DefaultMaterial=new o.Y({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:o.v})),h.DefaultMaterial):this.getDependency("material",c[i].material);d.push(e)}var h;return d.push(t.loadGeometries(c)),Promise.all(d).then((function(n){const d=n.slice(0,n.length-1),h=n[n.length-1],f=[];for(let i=0,n=h.length;i<n;i++){const n=h[i],m=c[i];let _;const v=d[i];if(m.mode===j||m.mode===F||m.mode===U||void 0===m.mode)_=!0===l.isSkinnedMesh?new o.Bb(n,v):new o.R(n,v),!0!==_.isSkinnedMesh||_.geometry.attributes.skinWeight.normalized||_.normalizeSkinWeights(),m.mode===F?_.geometry=le(_.geometry,o.Lb):m.mode===U&&(_.geometry=le(_.geometry,o.Kb));else if(m.mode===I)_=new o.G(n,v);else if(m.mode===D)_=new o.D(n,v);else if(m.mode===H)_=new o.F(n,v);else{if(m.mode!==N)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);_=new o.mb(n,v)}Object.keys(_.geometry.morphAttributes).length>0&&te(_,l),_.name=t.createUniqueName(l.name||"mesh_"+e),ee(_,l),m.extensions&&$(r,_,m),t.assignFinalMaterial(_),f.push(_)}if(1===f.length)return f[0];const m=new o.w;for(let i=0,e=f.length;i<e;i++)m.add(f[i]);return m}))}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new o.ib(o.P.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new o.gb(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),ee(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))}loadAnimation(e){const t=this.json.animations[e],n=[],r=[],l=[],c=[],d=[];for(let i=0,e=t.channels.length;i<e;i++){const e=t.channels[i],o=t.samplers[e.sampler],h=e.target,f=void 0!==h.node?h.node:h.id,input=void 0!==t.parameters?t.parameters[o.input]:o.input,output=void 0!==t.parameters?t.parameters[o.output]:o.output;n.push(this.getDependency("node",f)),r.push(this.getDependency("accessor",input)),l.push(this.getDependency("accessor",output)),c.push(o),d.push(h)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(l),Promise.all(c),Promise.all(d)]).then((function(n){const r=n[0],l=n[1],c=n[2],d=n[3],h=n[4],f=[];for(let i=0,e=r.length;i<e;i++){const e=r[i],t=l[i],n=c[i],m=d[i],_=h[i];if(void 0===e)continue;let v;switch(e.updateMatrix(),e.matrixAutoUpdate=!0,X[_.path]){case X.weights:v=o.eb;break;case X.rotation:v=o.qb;break;case X.position:case X.scale:default:v=o.Pb}const y=e.name?e.name:e.uuid,w=void 0!==m.interpolation?Y[m.interpolation]:o.C,x=[];X[_.path]===X.weights?e.traverse((function(object){!0===object.isMesh&&object.morphTargetInfluences&&x.push(object.name?object.name:object.uuid)})):x.push(y);let E=n.array;if(n.normalized){const e=se(E.constructor),t=new Float32Array(E.length);for(let n=0,o=E.length;n<o;n++)t[n]=E[n]*e;E=t}for(let e=0,n=x.length;e<n;e++){const track=new v(x[e]+"."+X[_.path],t.array,E,w);"CUBICSPLINE"===m.interpolation&&(track.createInterpolant=function(e){return new P(this.times,this.values,this.getValueSize()/3,e)},track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),f.push(track)}}const m=t.name?t.name:"animation_"+e;return new o.c(m,void 0,f)}))}createNodeMesh(e){const t=this.json,n=this,o=t.nodes[e];return void 0===o.mesh?null:n.getDependency("mesh",o.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,o.mesh,e);return void 0!==o.weights&&t.traverse((function(e){if(e.isMesh)for(let i=0,t=o.weights.length;i<t;i++)e.morphTargetInfluences[i]=o.weights[i]})),t}))}loadNode(e){const t=this.json,n=this.extensions,r=this,l=t.nodes[e],c=l.name?r.createUniqueName(l.name):"";return function(){const t=[],n=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return n&&t.push(n),void 0!==l.camera&&t.push(r.getDependency("camera",l.camera).then((function(e){return r._getNodeRef(r.cameraCache,l.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){let d;if(d=!0===l.isBone?new o.f:t.length>1?new o.w:1===t.length?t[0]:new o.fb,d!==t[0])for(let i=0,e=t.length;i<e;i++)d.add(t[i]);if(l.name&&(d.userData.name=l.name,d.name=c),ee(d,l),l.extensions&&$(n,d,l),void 0!==l.matrix){const e=new o.Q;e.fromArray(l.matrix),d.applyMatrix4(e)}else void 0!==l.translation&&d.position.fromArray(l.translation),void 0!==l.rotation&&d.quaternion.fromArray(l.rotation),void 0!==l.scale&&d.scale.fromArray(l.scale);return r.associations.set(d,{type:"nodes",index:e}),d}))}loadScene(e){const t=this.json,n=this.extensions,r=this.json.scenes[e],l=this,c=new o.w;r.name&&(c.name=l.createUniqueName(r.name)),ee(c,r),r.extensions&&$(n,c,r);const d=r.nodes||[],h=[];for(let i=0,e=d.length;i<e;i++)h.push(re(d[i],c,t,l));return Promise.all(h).then((function(){return c}))}}function re(e,t,n,r){const l=n.nodes[e];return r.getDependency("node",e).then((function(e){if(void 0===l.skin)return e;let t;return r.getDependency("skin",l.skin).then((function(e){t=e;const n=[];for(let i=0,e=t.joints.length;i<e;i++)n.push(r.getDependency("node",t.joints[i]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(!e.isMesh)return;const r=[],l=[];for(let e=0,c=n.length;e<c;e++){const c=n[e];if(c){r.push(c);const n=new o.Q;void 0!==t.inverseBindMatrices&&n.fromArray(t.inverseBindMatrices.array,16*e),l.push(n)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[e])}e.bind(new o.Ab(r,l),e.matrixWorld)})),e}))})).then((function(e){t.add(e);const o=[];if(l.children){const t=l.children;for(let i=0,l=t.length;i<l;i++){const l=t[i];o.push(re(l,e,n,r))}}return Promise.all(o)}))}function ae(e,t,n){const r=t.attributes,l=[];function c(t,o){return n.getDependency("accessor",t).then((function(t){e.setAttribute(o,t)}))}for(const t in r){const n=K[t]||t.toLowerCase();n in e.attributes||l.push(c(r[t],n))}if(void 0!==t.indices&&!e.index){const o=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));l.push(o)}return ee(e,t),function(e,t,n){const r=t.attributes,l=new o.g;if(void 0===r.POSITION)return;{const e=n.json.accessors[r.POSITION],t=e.min,c=e.max;if(void 0===t||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(l.set(new o.Ob(t[0],t[1],t[2]),new o.Ob(c[0],c[1],c[2])),e.normalized){const t=se(B[e.componentType]);l.min.multiplyScalar(t),l.max.multiplyScalar(t)}}const c=t.targets;if(void 0!==c){const e=new o.Ob,t=new o.Ob;for(let i=0,o=c.length;i<o;i++){const o=c[i];if(void 0!==o.POSITION){const r=n.json.accessors[o.POSITION],l=r.min,c=r.max;if(void 0!==l&&void 0!==c){if(t.setX(Math.max(Math.abs(l[0]),Math.abs(c[0]))),t.setY(Math.max(Math.abs(l[1]),Math.abs(c[1]))),t.setZ(Math.max(Math.abs(l[2]),Math.abs(c[2]))),r.normalized){const e=se(B[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}l.expandByVector(e)}e.boundingBox=l;const d=new o.Cb;l.getCenter(d.center),d.radius=l.min.distanceTo(l.max)/2,e.boundingSphere=d}(e,t,n),Promise.all(l).then((function(){return void 0!==t.targets?function(e,t,n){let o=!1,r=!1;for(let i=0,e=t.length;i<e;i++){const e=t[i];if(void 0!==e.POSITION&&(o=!0),void 0!==e.NORMAL&&(r=!0),o&&r)break}if(!o&&!r)return Promise.resolve(e);const l=[],c=[];for(let i=0,d=t.length;i<d;i++){const d=t[i];if(o){const t=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):e.attributes.position;l.push(t)}if(r){const t=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):e.attributes.normal;c.push(t)}}return Promise.all([Promise.all(l),Promise.all(c)]).then((function(t){const n=t[0],l=t[1];return o&&(e.morphAttributes.position=n),r&&(e.morphAttributes.normal=l),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function le(e,t){let n=e.getIndex();if(null===n){const t=[],o=e.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let i=0;i<o.count;i++)t.push(i);e.setIndex(t),n=e.getIndex()}const r=n.count-2,l=[];if(t===o.Kb)for(let i=1;i<=r;i++)l.push(n.getX(0)),l.push(n.getX(i)),l.push(n.getX(i+1));else for(let i=0;i<r;i++)i%2==0?(l.push(n.getX(i)),l.push(n.getX(i+1)),l.push(n.getX(i+2))):(l.push(n.getX(i+2)),l.push(n.getX(i+1)),l.push(n.getX(i)));l.length/3!==r&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const c=e.clone();return c.setIndex(l),c}},332:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(273);const r=new WeakMap;class l extends o.K{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(path){return this.decoderPath=path,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const l=new o.t(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(e=>{const n={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,n).then(t).catch(r)}),n,r)}decodeDracoFile(e,t,n,o){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const e in t.attributeTypes){const n=t.attributeTypes[e];void 0!==n.BYTES_PER_ELEMENT&&(t.attributeTypes[e]=n.name)}const n=JSON.stringify(t);if(r.has(e)){const t=r.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let o;const l=this.workerNextTaskID++,c=e.byteLength,d=this._getWorker(l,c).then((n=>(o=n,new Promise(((n,r)=>{o._callbacks[l]={resolve:n,reject:r},o.postMessage({type:"decode",id:l,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return d.catch((()=>!0)).then((()=>{o&&l&&this._releaseTask(o,l)})),r.set(e,{key:n,promise:d}),d}_createGeometry(e){const t=new o.j;e.index&&t.setIndex(new o.i(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const n=e.attributes[i],r=n.name,l=n.array,c=n.itemSize;t.setAttribute(r,new o.i(l,c))}return t}_loadLibrary(e,t){const n=new o.t(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise(((t,o)=>{n.load(e,t,void 0,o)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const o=c.toString(),body=["/* draco decoder */",n,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([body]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(a,b){return a._taskLoad>b._taskLoad?-1:1}));const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let i=0;i<this.workerPool.length;++i)this.workerPool[i].terminate();return this.workerPool.length=0,this}}function c(){let e,t;function n(e,t,n,o,r,l){const c=l.num_components(),d=n.num_points()*c,h=d*r.BYTES_PER_ELEMENT,f=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,r),m=e._malloc(h);t.GetAttributeDataArrayForAllPoints(n,l,f,h,m);const _=new r(e.HEAPF32.buffer,m,d).slice();return e._free(m),{name:o,array:_,itemSize:c}}onmessage=function(o){const r=o.data;switch(r.type){case"init":e=r.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const o=r.buffer,l=r.taskConfig;t.then((e=>{const t=e.draco,c=new t.Decoder,d=new t.DecoderBuffer;d.Init(new Int8Array(o),o.byteLength);try{const e=function(e,t,o,r){const l=r.attributeIDs,c=r.attributeTypes;let d,h;const f=t.GetEncodedGeometryType(o);if(f===e.TRIANGULAR_MESH)d=new e.Mesh,h=t.DecodeBufferToMesh(o,d);else{if(f!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");d=new e.PointCloud,h=t.DecodeBufferToPointCloud(o,d)}if(!h.ok()||0===d.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+h.error_msg());const m={index:null,attributes:[]};for(const o in l){const h=self[c[o]];let f,_;if(r.useUniqueIDs)_=l[o],f=t.GetAttributeByUniqueId(d,_);else{if(_=t.GetAttributeId(d,e[l[o]]),-1===_)continue;f=t.GetAttribute(d,_)}m.attributes.push(n(e,t,d,o,h,f))}f===e.TRIANGULAR_MESH&&(m.index=function(e,t,n){const o=3*n.num_faces(),r=4*o,l=e._malloc(r);t.GetTrianglesUInt32Array(n,r,l);const c=new Uint32Array(e.HEAPF32.buffer,l,o).slice();return e._free(l),{array:c,itemSize:1}}(e,t,d));return e.destroy(d),m}(t,c,d,l),o=e.attributes.map((e=>e.array.buffer));e.index&&o.push(e.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:e},o)}catch(e){console.error(e),self.postMessage({type:"error",id:r.id,error:e.message})}finally{t.destroy(d),t.destroy(c)}}))}}}}}]);